/**
 * Tailwind CSS imports and custom styles for Hextris
 */

@import 'tailwindcss/base';
@import 'tailwindcss/components';
@import 'tailwindcss/utilities';

/* Google Fonts - Exo 2 */
@import url('https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;500;600;700;800;900&display=swap');

/* Custom base styles */
@layer base {
  :root {
    --theme-bg: #ecf0f1;
    --theme-surface: #ffffff;
    --theme-surface-muted: #f3f4f6;
    --theme-border: #d1d5db;
    --theme-text: #2c3e50;
    --theme-text-secondary: #7f8c8d;
    --theme-accent: #2c3e50;
    --theme-accent-contrast: #ffffff;
    --theme-surface-contrast: #0b1120;
    --theme-surface-glass: rgba(255, 255, 255, 0.82);
    --theme-surface-muted-glass: rgba(255, 255, 255, 0.65);
    --theme-border-glass: rgba(209, 213, 219, 0.5);
    --theme-glass-shadow: 0 25px 60px rgba(15, 23, 42, 0.25);
    --theme-glow: rgba(15, 23, 42, 0.25);
    --theme-glow-strong: rgba(15, 23, 42, 0.45);
    --theme-accent-strong: #3b4a64;
    --theme-accent-soft: #1f2b3f;
    --theme-bg-muted: #f5f7fa;
  }

  * {
    @apply antialiased;
  }

  body {
    @apply font-sans m-0 p-0 overflow-x-hidden;
    font-family: 'Exo 2', system-ui, -apple-system, sans-serif;
    background: var(--theme-bg);
    color: var(--theme-text);
  }

  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  #app {
    @apply w-full min-h-screen relative;
  }
}

/* Custom components */
@layer components {
  .page {
    @apply animate-fade-in;
    min-height: 100vh;
    position: relative;
    background: var(--theme-bg);
    color: var(--theme-text);
  }

  .theme-page {
    background: radial-gradient(circle at top, color-mix(in srgb, var(--theme-bg) 85%, transparent) 0%, var(--theme-bg) 45%)
      fixed;
    color: var(--theme-text);
    isolation: isolate;
  }

  .theme-card {
    background: var(--theme-surface-glass);
    border: 1px solid var(--theme-border-glass);
    color: var(--theme-text);
    box-shadow: var(--theme-glass-shadow);
    backdrop-filter: blur(18px);
    -webkit-backdrop-filter: blur(18px);
  }

  .theme-swatch {
    width: 1.25rem;
    height: 1.25rem;
    border: 1px solid var(--theme-border);
    background: var(--theme-surface);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s ease;
  }

  .theme-swatch-circle {
    border-radius: 9999px;
  }

  .theme-swatch-pill {
    border-radius: 9999px;
    width: 2rem;
  }

  .theme-swatch-diamond {
    transform: rotate(45deg);
    border-radius: 0.35rem;
  }

  .theme-swatch-hex {
    clip-path: polygon(25% 6%, 75% 6%, 100% 50%, 75% 94%, 25% 94%, 0% 50%);
  }

  .theme-swatch-spark {
    clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
  }

  .theme-card-muted {
    background: var(--theme-surface-muted-glass);
    border: 1px solid var(--theme-border-glass);
    color: var(--theme-text);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }

  .theme-text {
    color: var(--theme-text);
  }

  .theme-text-secondary {
    color: var(--theme-text-secondary);
  }

  .theme-text-hover:hover {
    color: var(--theme-text);
  }

  .theme-border {
    border-color: var(--theme-border);
  }

  /* Glassmorphic card effect */
  .glass,
  .theme-glass {
    background: var(--theme-surface-glass);
    border: 1px solid var(--theme-border-glass);
    box-shadow: var(--theme-glass-shadow);
    backdrop-filter: blur(26px);
    -webkit-backdrop-filter: blur(26px);
  }

  .theme-aurora {
    position: absolute;
    inset: 0;
    pointer-events: none;
    background:
      radial-gradient(circle at 20% 20%, var(--theme-glow-strong) 0%, transparent 55%),
      radial-gradient(circle at 80% 0%, var(--theme-glow) 0%, transparent 60%);
    filter: blur(30px) saturate(120%);
    opacity: 0.75;
    z-index: 0;
  }

  .theme-grid-overlay {
    position: absolute;
    inset: 0;
    pointer-events: none;
    background-image:
      linear-gradient(rgba(255, 255, 255, 0.04) 1px, transparent 1px),
      linear-gradient(90deg, rgba(255, 255, 255, 0.04) 1px, transparent 1px);
    background-size: 80px 80px;
    opacity: 0.4;
    z-index: 0;
  }

  /* Button hover effects */
  .btn-hover-scale {
    @apply transition-transform duration-200 hover:scale-105 active:scale-95;
  }

  /* Text shadows for canvas text */
  .text-shadow {
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
  }

  .text-shadow-white {
    text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.8);
  }

  .theme-btn {
    @apply font-semibold transition-all duration-200 rounded-xl whitespace-normal break-words;
    border: none;
    outline: none;
    box-shadow: none;
    position: relative;
    isolation: isolate;
  }

  .theme-btn:focus-visible {
    outline: 2px solid var(--theme-accent);
    outline-offset: 2px;
  }

  .theme-btn-primary {
    background-image: linear-gradient(135deg, var(--theme-accent-strong), var(--theme-accent));
    color: var(--theme-accent-contrast);
    border: 1px solid var(--theme-accent-soft);
    box-shadow: 0 18px 40px var(--theme-glow);
  }

  .theme-btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 24px 50px var(--theme-glow);
  }

  .theme-btn-primary:active {
    transform: translateY(0);
  }

  .theme-btn-secondary {
    background: var(--theme-surface-glass);
    border: 1px solid var(--theme-border-glass);
    color: var(--theme-text);
    box-shadow: var(--theme-glass-shadow);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
  }

  .theme-btn-outline {
    background: transparent;
    border: 1.5px dashed var(--theme-border);
    color: var(--theme-text);
  }

  .theme-btn-outline:hover {
    border-style: solid;
    border-color: var(--theme-accent);
    color: var(--theme-accent);
  }

  .theme-btn-ghost {
    background: transparent;
    color: var(--theme-text-secondary);
  }

  .theme-btn-ghost:hover {
    color: var(--theme-text);
    background: var(--theme-surface-muted-glass);
  }

  .scroll-button {
    position: fixed;
    bottom: clamp(1rem, 3vh, 1.5rem);
    right: clamp(1rem, 3vw, 1.5rem);
    width: 3rem;
    height: 3rem;
    border-radius: 9999px;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 60;
    box-shadow: 0 10px 30px var(--theme-glow);
    transition: transform 0.2s ease, opacity 0.2s ease;
  }

  .scroll-button:hover {
    transform: translateY(-2px) scale(1.03);
  }

  .scroll-button svg {
    pointer-events: none;
  }

  .game-effect-layer {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 5;
  }

  .game-effect-slowmo {
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center, color-mix(in srgb, var(--theme-accent) 45%, transparent) 0%, transparent 70%);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    gap: 0.35rem;
    color: var(--theme-accent-contrast);
    font-weight: 700;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    text-align: center;
    animation: slowMoPulse 1.2s ease-in-out infinite;
  }

  .game-effect-label {
    font-size: 0.75rem;
    letter-spacing: 0.5em;
  }

  .game-effect-timer {
    font-size: 1.5rem;
    font-variant-numeric: tabular-nums;
    text-shadow: 0 0 18px rgba(0, 0, 0, 0.4);
  }

  .game-canvas-slowmo {
    filter: saturate(0.85) brightness(1.05);
    transition: filter 0.2s ease;
  }

  .game-canvas-shield {
    filter: drop-shadow(0 0 18px var(--theme-glow));
    transition: filter 0.2s ease;
  }

  .game-canvas-life-lost {
    animation: canvasShake 0.3s ease-out;
  }

  .game-effect-hammer {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    mix-blend-mode: screen;
  }

  .game-effect-hammer-flash {
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center, color-mix(in srgb, var(--theme-accent) 35%, transparent) 0%, transparent 65%);
    animation: hammerFlash 0.55s ease-out forwards;
  }

  .game-effect-hammer-burst {
    position: relative;
    width: min(38vh, 38vw);
    aspect-ratio: 1 / 1;
    filter: drop-shadow(0 18px 45px rgba(0, 0, 0, 0.35));
  }

  .game-effect-hammer-impact {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 18%;
    height: 18%;
    border-radius: 9999px;
    transform: translate(-50%, -50%) scale(0.4);
    background: radial-gradient(circle, var(--theme-accent-contrast) 0%, var(--theme-accent) 70%);
    box-shadow: 0 0 45px var(--theme-glow-strong), 0 0 18px var(--theme-accent);
    animation: hammerImpactCore 0.55s ease-out forwards;
  }

  .game-effect-hammer-ring {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 32%;
    height: 32%;
    border-radius: 50%;
    border: 2px solid color-mix(in srgb, var(--theme-accent) 75%, var(--theme-accent-contrast));
    opacity: 0.85;
    transform: translate(-50%, -50%) scale(0.25);
    animation: hammerShockwave 0.95s ease-out forwards;
  }

  .game-effect-hammer-spark {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 4px;
    height: 30px;
    border-radius: 9999px;
    background: linear-gradient(180deg, var(--theme-accent-contrast), color-mix(in srgb, var(--theme-accent) 75%, transparent));
    box-shadow: 0 0 18px rgba(0, 0, 0, 0.25);
    opacity: 0;
    transform-origin: center 110%;
    transform: translate(-50%, -50%) rotate(var(--spark-angle, 0deg));
    animation: hammerSpark 0.8s ease-out forwards;
  }

  .game-effect-shield {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.96);
    width: min(45vh, 45vw);
    aspect-ratio: 1/1;
    border-radius: 50%;
    border: 3px solid color-mix(in srgb, var(--theme-accent) 85%, var(--theme-accent-contrast));
    box-shadow: 0 0 35px var(--theme-glow-strong);
    animation: shieldPulse 1.6s ease-in-out infinite;
    mix-blend-mode: screen;
  }

  .game-effect-surge {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.25rem;
    text-transform: uppercase;
    font-weight: 800;
    letter-spacing: 0.5em;
    color: var(--theme-accent-contrast);
    background: radial-gradient(circle, rgba(0, 0, 0, 0) 40%, rgba(0, 0, 0, 0.45) 85%);
    backdrop-filter: blur(2px);
    animation: surgePulse 1.1s ease-in-out infinite;
    pointer-events: none;
    z-index: 6;
  }

  .game-effect-surge span {
    font-size: clamp(1rem, 2vw, 1.75rem);
    letter-spacing: 0.8em;
  }

  .game-effect-surge p {
    font-size: clamp(0.6rem, 1.3vw, 0.9rem);
    letter-spacing: 0.4em;
    opacity: 0.85;
  }

  .theme-input {
    width: 100%;
    border-radius: 0.9rem;
    border: 1px solid var(--theme-border-glass);
    background: var(--theme-surface-glass);
    padding: 0.85rem 1rem;
    color: var(--theme-text);
    transition: border 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
    box-shadow: inset 0 0 0 1px transparent;
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
  }

  .theme-input::placeholder {
    color: color-mix(in srgb, var(--theme-text-secondary) 80%, transparent);
  }

  .theme-input:focus {
    border-color: var(--theme-accent);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08), 0 0 0 2px var(--theme-glow);
    outline: none;
    transform: translateY(-1px);
  }

  .theme-input-error {
    border-color: #f87171 !important;
    box-shadow: 0 0 0 2px rgba(248, 113, 113, 0.35);
  }

  .theme-label {
    color: var(--theme-text-secondary);
    font-weight: 600;
    letter-spacing: 0.02em;
    text-transform: uppercase;
  }

  .theme-tab {
    @apply rounded-xl font-semibold text-sm sm:text-base transition-all duration-200 text-center;
    background: var(--theme-surface-muted-glass);
    color: var(--theme-text-secondary);
    border: 1px solid transparent;
    padding: 0.75rem 1rem;
  }

  .theme-tab-active {
    color: var(--theme-accent-contrast);
    background-image: linear-gradient(120deg, var(--theme-accent-strong), var(--theme-accent));
    border-color: var(--theme-accent-soft);
    box-shadow: 0 18px 30px var(--theme-glow);
  }

  .theme-inline-message {
    color: var(--theme-text-secondary);
    font-size: 0.9rem;
  }

  .difficulty-card {
    position: relative;
    overflow: hidden;
  }

  .difficulty-card::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, transparent, color-mix(in srgb, var(--theme-accent) 20%, transparent));
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
  }

  .difficulty-card:hover::after {
    opacity: 1;
  }

  .difficulty-card.selected {
    border-color: var(--theme-accent) !important;
    box-shadow: 0 30px 55px var(--theme-glow);
    transform: translateY(-4px);
  }

  .difficulty-card:not(.selected):hover {
    border-color: color-mix(in srgb, var(--theme-accent) 35%, var(--theme-border));
  }
}

/* Custom utilities */
@layer utilities {
  /* Hide scrollbar but keep functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Safe area for mobile notches */
  .safe-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* Prevent text selection during gameplay */
  .no-select {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

  /* Touch action for mobile */
  .touch-none {
    touch-action: none;
  }
}

/* Animation keyframes */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

@keyframes scaleIn {
  from {
    transform: scale(0.9);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    transform: translateY(20px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slideDown {
  from {
    transform: translateY(-20px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slowMoPulse {
  0% {
    opacity: 0.6;
  }
  50% {
    opacity: 1;
  }
  100% {
    opacity: 0.6;
  }
}

@keyframes surgePulse {
  0% {
    opacity: 0.5;
    transform: scale(0.96);
  }
  50% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    opacity: 0.5;
    transform: scale(0.96);
  }
}

@keyframes hammerShockwave {
  0% {
    opacity: 0.85;
    transform: translate(-50%, -50%) scale(0.25);
    border-width: 4px;
  }
  70% {
    opacity: 0.4;
  }
  100% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(2.7);
    border-width: 1px;
  }
}

@keyframes hammerSpark {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) rotate(var(--spark-angle, 0deg)) scaleY(0.25);
  }
  30% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translate(-50%, -50%) rotate(var(--spark-angle, 0deg)) translateY(-110px) scaleY(0.45);
  }
}

@keyframes hammerImpactCore {
  0% {
    opacity: 0.7;
    transform: translate(-50%, -50%) scale(0.35);
  }
  60% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  100% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0);
  }
}

@keyframes hammerFlash {
  0% {
    opacity: 0.5;
    transform: scale(0.85);
  }
  70% {
    opacity: 0.15;
  }
  100% {
    opacity: 0;
    transform: scale(1.35);
  }
}

@keyframes shieldPulse {
  0% {
    box-shadow: 0 0 20px var(--theme-glow);
    opacity: 0.7;
    transform: translate(-50%, -50%) scale(0.92);
  }
  70% {
    box-shadow: 0 0 45px var(--theme-glow-strong);
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  100% {
    opacity: 0.7;
    transform: translate(-50%, -50%) scale(0.92);
  }
}

@keyframes lifeLostFlash {
  0% {
    opacity: 0.7;
  }
  40% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
}

@keyframes canvasShake {
  0%, 100% {
    transform: translateX(0);
  }
  10%, 30%, 50%, 70%, 90% {
    transform: translateX(-4px);
  }
  20%, 40%, 60%, 80% {
    transform: translateX(4px);
  }
}

/* Canvas container */
.canvas-container {
  @apply relative w-full h-full flex items-center justify-center;
}

/* Timer Attack HUD */
.timer-attack-display {
  @apply fixed top-4 left-4 z-30 px-3 py-2 rounded-lg border-2 border-gray-900 bg-white/90 text-sm font-bold text-gray-900 shadow-lg;
}

.timer-attack-display.normal {
  @apply text-gray-900;
}

.timer-attack-display.warning {
  @apply text-yellow-600 animate-pulse;
}

.timer-attack-display.critical {
  @apply text-red-600 animate-pulse;
}

.timer-mode-badge {
  @apply fixed top-16 left-4 z-30 px-3 py-1 rounded-full bg-black text-white text-[10px] font-semibold tracking-widest shadow-lg;
}

/* HUD overlays */
.hud-overlay {
  @apply fixed z-40 pointer-events-none;
}

.hud-overlay > * {
  @apply pointer-events-auto;
}

/* Loading spinner */
@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.animate-spin {
  animation: spin 1s linear infinite;
}

/* Pulse animation for hearts/lives */
@keyframes pulse {
  0%, 100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.8;
    transform: scale(1.1);
  }
}

.animate-pulse-custom {
  animation: pulse 1s ease-in-out infinite;
}

/* Mobile touch target sizing */
@media (pointer: coarse) {
  button,
  a,
  input {
    min-height: 48px;
    min-width: 48px;
  }
}

/* Print styles */
@media print {
  body {
    @apply bg-white;
  }
  
  .no-print {
    display: none !important;
  }
}
